# 保留你原有的 nacos.config.* 配置
nacos:
  discovery:
    enabled: false
  config:
    enabled: false
    server-addr: ${nacos_server_addr:172.16.9.88:18848}
    namespace: ${nacos_namespace:bf644fca-1276-415a-89de-428331e96a46}
    data-ids: ${nacos_data_ids:zhgd-person-lw,rysmz-common}
    group: ${nacos_group:rysmz}
    max-retry: 10
    type: properties
    auto-refresh: true
    bootstrap:
      enable: false
      log-enable: false
    username: ${nacos_username:nacos}
    password: ${nacos_password:sHL4RErzeB@kJMVnXPKfh9j}

spring:
  application:
    name: zhgd-workflow-server
  profiles:
    active: local
  # 修正：nacos import 配置语法错误
  config:
    import:
      - optional:nacos:zhgd-person-lw.properties?group=rysmz&namespace=bf644fca-1276-415a-89de-428331e96a46
      - optional:nacos:rysmz-common.properties?group=rysmz&namespace=bf644fca-1276-415a-89de-428331e96a46
  cloud:
    nacos:
      config:
        import-check:
          enabled: false  # 关闭导入检查，彻底消除报错
        # 复用 nacos.config 的配置（避免重复写）
        server-addr: ${nacos.config.server-addr}
        namespace: ${nacos.config.namespace}
        group: ${nacos.config.group}
        username: ${nacos.config.username}
        password: ${nacos.config.password}
  main:
    allow-circular-references: true # 允许循环依赖
  # Redis 配置
  redis:
    host: 172.16.9.201
    port: 6379
    password: ""
    database: 0
    timeout: 5000
    lettuce:
      pool:
        max-active: 8
        max-wait: -1ms
        max-idle: 8
        min-idle: 0
  # Servlet 配置
  servlet:
    multipart:
      max-file-size: 16MB
      max-request-size: 32MB
  # Jackson 配置
  jackson:
    serialization:
      write-dates-as-timestamps: true
      write-date-timestamps-as-nanoseconds: false
      write-durations-as-timestamps: true
      fail-on-empty-beans: false
  # Cache 配置
  cache:
    type: REDIS
    redis:
      time-to-live: 1h
  # Spring Data Redis 配置
  data:
    redis:
      repositories:
        enabled: false
  # Kafka 配置
  kafka:
    producer:
      acks: 1
      retries: 3
      value-serializer: org.springframework.kafka.support.serializer.JsonSerializer
    consumer:
      auto-offset-reset: earliest
      value-deserializer: org.springframework.kafka.support.serializer.JsonDeserializer
      properties:
        spring.json.trusted.packages: '*'
    listener:
      missing-topics-fatal: false

# Pinming cookie domain (login user parsing)
cookie:
  domain: zz-test05.pinming.org

# Redisson 配置（和 Redis 保持一致）
redisson:
  singleServerConfig:
    address: redis://172.16.9.201:6379  # 直接写死，不要用 ${} 变量
    password: ""
    database: 0
    timeout: 5000
    connectionPoolSize: 8
    connectionMinimumIdleSize: 0
  threads: 16
  nettyThreads: 32
  codec:
    class: org.redisson.codec.JsonJacksonCodec

server:
  servlet:
    encoding:
      enabled: true
      charset: UTF-8
      force: true

--- #################### 接口文档配置 ####################

springdoc:
  api-docs:
    enabled: true
    path: /v3/api-docs
  swagger-ui:
    enabled: true
    path: /swagger-ui
  default-flat-param-object: true

knife4j:
  enable: true
  setting:
    language: zh_cn

# 工作流 Flowable 配置
flowable:
  database-schema-update: true
  db-history-used: true
  check-process-definitions: false
  history-level: audit

# MyBatis Plus 配置
mybatis-plus:
  configuration:
    map-underscore-to-camel-case: true
  global-config:
    db-config:
      id-type: NONE
      logic-delete-value: 1
      logic-not-delete-value: 0
    banner: false
  type-aliases-package: ${zhgd.info.base-package}.module.*.dal.dataobject
  encryptor:
    password: XDV71a+xqStEA3WH

mybatis-plus-join:
  banner: false
  sub-table-logic: true
  ms-cache: true
  table-alias: t
  logic-del-type: on

--- #################### 消息队列相关 ####################

rocketmq:
  producer:
    group: ${spring.application.name}_PRODUCER

--- #################### AI 相关配置 ####################

zhgd:
  ai:
    gemini:
      enable: true
      api-key: AIzaSyAVoBxgoFvvte820vEQMma2LKBnC98bqMQ
      model: gemini-2.5-flash
    doubao:
      enable: true
      api-key: 5c1b5747-26d2-4ebd-a4e0-dd0e8d8b4272
      model: doubao-1-5-lite-32k-250115
    hunyuan:
      enable: true
      api-key: sk-abc
      model: hunyuan-turbo
    siliconflow:
      enable: true
      api-key: sk-epsakfenqnyzoxhmbucsxlhkdqlcbnimslqoivkshalvdozz
      model: deepseek-ai/DeepSeek-R1-Distill-Qwen-7B
    xinghuo:
      enable: true
      appKey: 75b161ed2aef4719b275d6e7f2a4d4cd
      secretKey: YWYxYWI2MTA4ODI2NGZlYTQyNjAzZTcz
      model: x1
    baichuan:
      enable: true
      api-key: sk-abc
      model: Baichuan4-Turbo
    midjourney:
      enable: true
      base-url: https://api.holdai.top/mj
      api-key: sk-dZEPiVaNcT3FHhef51996bAa0bC74806BeAb620dA5Da10Bf
      notify-url: http://java.nat300.top/api/ai/image/midjourney/notify
    suno:
      enable: true
      base-url: http://127.0.0.1:3001
    web-search:
      enable: true
      api-key: sk-40500e52840f4d24b956d0b1d80d9abe

--- #################### 智慧工地相关配置 ####################

zhgd:
  info:
    version: 1.0.0
    base-package: cn.iocoder.zhgd
  web:
    app-api:
      prefix: /app-api
      controller: "**.controller.app.**"
    admin-api:
      prefix: /api
      controller: "**.controller.admin.**"
    admin-ui:
      url: http://dashboard.zhgd.iocoder.cn
  xss:
    enable: false
    exclude-urls:
      - ${spring.boot.admin.context-path}/**
      - ${management.endpoints.web.base-path}/**
  security:
    permit-all_urls:
      - /api/mp/open/**
  api-encrypt:
    enable: true
    algorithm: AES
    request-key: 52549111389893486934626385991395
    response-key: 96103715984234343991809655248883
  websocket:
    enable: true
    path: /infra/ws
    sender-type: local
    sender-rocketmq:
      topic: ${spring.application.name}-websocket
      consumer-group: ${spring.application.name}-websocket-consumer
    sender-rabbitmq:
      exchange: ${spring.application.name}-websocket-exchange
      queue: ${spring.application.name}-websocket-queue
    sender-kafka:
      topic: ${spring.application.name}-websocket
      consumer-group: ${spring.application.name}-websocket-consumer
  swagger:
    title: 芋道快速开发平台
    description: 提供管理后台、用户 App 的所有功能
    version: ${zhgd.info.version}
    url: ${zhgd.web.admin-ui.url}
    email: xingyu4j@vip.qq.com
    license: MIT
    license-url: https://gitee.com/zhijiantianya/ruoyi-vue-pro/blob/master/LICENSE
  codegen:
    base-package: ${zhgd.info.base-package}
    db-schemas: ${spring.datasource.dynamic.datasource.master.name}
    front-type: 20
    vo-type: 10
    delete-batch-enable: true
    unit-test-enable: false
  tenant:
    enable: false
    ignore-urls:
      - /jmreport/*
    ignore-visit-urls:
      - /admin-api/system/user/profile/**
      - /admin-api/system/auth/**
    ignore-tables: []
    ignore-caches:
      - user_role_ids
      - permission_menu_ids
      - oauth_client
      - notify_template
      - mail_account
      - mail_template
      - sms_template
      - iot:device
      - iot:thing_model_list
  sms-code:
    expire-times: 10m
    send-frequency: 1m
    send-maximum-quantity-per-day: 10
    begin-code: 9999
    end-code: 9999
  trade:
    order:
      pay-expire-time: 2h
      receive-expire-time: 14d
      comment-expire-time: 7d
      status-sync-to-wxa-enable: true
    express:
      client: kd_100
      kd-niao:
        api-key: cb022f1e-48f1-4c4a-a723-9001ac9676b8
        business-id: 1809751
        request-type: 1002
      kd100:
        key: pLXUGAwK5305
        customer: E77DF18BE109F454A5CD319E44BF5177
  iot:
    message-bus:
      type: redis

debug: false
yudao:
  security:
    login-check-enabled: false   # 默认跳过登录
    permission-check-enabled: false